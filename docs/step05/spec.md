# 📄 Step 5 規格書

## 1. 階段目標
- 讀取 `tap.base_gain` 設定，計算單擊獲得的迷因點數。
- 加入最小點擊間隔（cooldown），避免玩家使用多點觸控或自動點擊器作弊。
- 預設 `tap.base_gain = 0.5 秒`。

---

## 2. 功能需求
1. 玩家在主畫面點擊角色 → 增加資源數值。
2. 點擊收益依據 `tap.base_gain` 間隔判斷，若在冷卻中則忽略該點擊。
3. 點擊間隔的單位為「秒」，可透過設定檔 (`game.json`) 動態調整。
4. 可透過 Debug 面板監控 `tap.base_gain` 與點擊事件計數。

---

## 3. 驗收標準
- ✅ 玩家單擊角色，若間隔 ≥ 0.5 秒，立即增加 +base 資源。
- ✅ 玩家瞬間連點 10 下，若間隔均 < 0.5 秒，最終只計算一次（資源僅 +base）。
- ✅ 玩家持續每秒點擊一次，資源會正確累積，每次都增加 +base。
- ✅ 修改 `game.json` 中的 `tap.base_gain` 後，能透過熱載反映在遊戲行為。

---

## 4. 實例化需求測試案例

### 測試案例 1：單點擊有效
- **Given** 當前資源 = 0，`tap.base=1`，`tap.base_gain=0.5s`  
- **When** 玩家單擊角色一次  
- **Then** 資源應立即變為 1  

---

### 測試案例 2：連點防作弊
- **Given** 當前資源 = 0，`tap.base=1`，`tap.base_gain=0.5s`  
- **When** 玩家在 0.1 秒內快速連點 10 下  
- **Then** 資源應僅增加 1（而非 10）  

---

### 測試案例 3：間隔符合累積
- **Given** 當前資源 = 0，`tap.base=1`，`tap.base_gain=0.5s`  
- **When** 玩家每隔 1 秒點擊角色 5 次  
- **Then** 資源應最終增加 5  

---

## 5. 限制與備註
- 冷卻判斷應以 **最後一次有效點擊時間戳** 為基準。  
- 使用 Flutter Flame 的 GestureDetector / TapComponent 實作點擊事件。  
- 點擊檢測需與 **角色區域 hitbox** 綁定，避免誤觸 UI 按鈕。  
- 本階段僅計算資源增加，後續動效（數字彈跳、特效動畫）已在階段 4 定義，不需重複。  
